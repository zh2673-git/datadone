# 多维分析工具 v0.1.0

## 📋 项目概述

多维分析工具是一个专业的多源数据分析系统，专门用于处理和分析银行、微信、支付宝、话单等多种数据源。系统采用模块化设计，提供全面的数据分析功能，包括频率分析、时间模式分析、金额分析、综合交叉分析等，并支持Excel和Word格式的专业报告导出。

## 🎯 版本信息
- **当前版本**: v0.1.0
- **发布日期**: 2025年
- **主要特性**: 多源数据整合、智能交叉分析、专业报告导出

## 🏗️ 系统架构

```
多维分析工具 v0.1.0/
├── src/                          # 源代码目录
│   ├── model/                    # 数据模型模块
│   │   ├── base_model.py         # 数据模型基类
│   │   ├── bank_model.py         # 银行数据模型
│   │   ├── call_model.py         # 话单数据模型
│   │   ├── payment_model.py      # 支付数据模型基类
│   │   ├── wechat_model.py       # 微信数据模型
│   │   └── alipay_model.py       # 支付宝数据模型
│   ├── analysis/                 # 分析模块
│   │   ├── base_analyzer.py      # 分析器基类
│   │   ├── bank_analyzer.py      # 银行数据分析器
│   │   ├── call_analyzer.py      # 话单数据分析器
│   │   ├── comprehensive_analyzer.py  # 综合分析器
│   │   └── payment/              # 支付分析子模块
│   ├── export/                   # 导出模块
│   │   ├── base_exporter.py      # 导出器基类
│   │   ├── excel_exporter.py     # Excel导出器
│   │   └── word_exporter.py      # Word导出器
│   ├── interface/                # 用户界面模块
│   │   ├── base_interface.py     # 界面基类
│   │   ├── cli_interface.py      # 主命令行界面
│   │   ├── cli_interface_export.py # 导出界面
│   │   └── cli_interface_group.py # 分组界面
│   └── utils/                    # 工具模块
│       ├── config.py             # 配置管理
│       ├── constants.py          # 常量定义
│       ├── exceptions.py         # 异常定义
│       ├── logger.py             # 日志管理
│       └── 其他工具子模块
├── config.json                   # 配置文件
├── main.py                       # 主程序入口
├── requirements.txt              # 依赖包列表
├── generate_sample_data.py       # 示例数据生成器
└── README.md                     # 项目说明文档
```

## 🔧 核心功能模块

### 数据模型模块 (model/)
- **基础数据模型**: 提供数据模型的基类定义和通用功能
- **银行数据模型**: 处理银行交易数据，支持存取现识别、收支分类
- **话单数据模型**: 处理通话记录数据，支持通话时长、频率统计
- **微信数据模型**: 处理微信支付数据，支持转账、红包等交易类型
- **支付宝数据模型**: 处理支付宝交易数据，支持多种支付场景

### 分析模块 (analysis/)
- **基础分析器**: 提供分析器的基类定义和通用分析方法
- **银行分析器**: 提供银行数据的频率分析、金额分析、时间模式分析
- **话单分析器**: 提供通话频率分析、时间分布分析、联系人分析
- **综合分析器**: 跨数据源的关联分析、交叉验证分析

### 导出模块 (export/)
- **基础导出器**: 提供导出器的基类定义和通用导出功能
- **Excel导出器**: 生成结构化的Excel分析报告，包含多个核心工作表
- **Word导出器**: 生成专业的Word分析报告，支持按人员分组显示

### 用户界面模块 (interface/)
- **基础界面**: 提供界面类的基类定义和通用界面功能
- **主命令行界面**: 提供系统的主要交互界面和功能入口
- **导出界面**: 专门处理报告导出相关的用户交互
- **分组界面**: 处理数据分组和分析相关的用户交互

### 工具模块 (utils/)
- **配置管理**: 统一的配置文件管理，支持字段映射和参数配置
- **常量定义**: 系统常量和配置参数的集中管理
- **异常处理**: 完善的异常定义和处理机制
- **日志管理**: 系统运行日志的记录和管理

## 🏛️ 模块架构说明

### 主模块文件夹功能
主模块文件夹（analysis/, export/, interface/, model/）负责系统的核心业务逻辑：

- **model/**: 数据模型层，定义数据结构和业务实体
  - 负责数据验证、转换和基础处理
  - 提供统一的数据访问接口

- **analysis/**: 分析引擎层，实现各种分析算法
  - 包含频率分析、金额分析、时间分析等核心算法
  - 提供综合分析功能，支持多数据源交叉分析

- **export/**: 导出功能层，负责报告生成
  - 支持Excel和Word格式的专业报告导出
  - 提供报告模板和格式化功能

- **interface/**: 用户界面层，处理用户交互
  - 提供命令行界面和用户交互逻辑
  - 负责输入验证和结果展示

### 工具模块文件夹功能
工具模块文件夹（utils/）提供辅助功能和通用工具：

- **utils/analysis/**: 分析工具子模块
  - `advanced_analysis.py`: 高级分析算法实现
  - `behavior_analysis.py`: 行为模式分析工具
  - `format_helpers.py`: 数据格式化辅助函数

- **utils/export/**: 导出工具子模块
  - `excel_helpers.py`: Excel导出辅助函数
  - `word_helpers.py`: Word导出辅助函数
  - `excel_export/`: Excel导出专用工具
  - `word_export/`: Word导出专用工具

- **utils/group/**: 分组管理工具
  - `group_manager.py`: 数据分组和分类管理

- **utils/model/**: 模型工具子模块
  - `cash_recognition.py`: 存取现识别算法
  - `data_helpers.py`: 数据处理辅助函数
  - `key_transactions.py`: 关键交易识别工具

### 功能区别说明

**主模块文件夹特点：**
- 实现核心业务逻辑和主要功能
- 模块间有明确的依赖关系
- 提供面向用户的主要功能接口
- 包含完整的业务处理流程

**工具模块文件夹特点：**
- 提供可重用的辅助函数和工具类
- 模块相对独立，功能单一
- 为主模块提供技术支持和功能扩展
- 包含算法实现和数据处理工具

**设计原则：**
- **分离关注点**: 业务逻辑与工具功能分离
- **模块化设计**: 每个模块职责单一，便于维护
- **可扩展性**: 工具模块便于添加新功能
- **代码复用**: 通用功能封装为工具函数

## 📊 分析功能特性

### 基础分析
- **频率分析**: 统计交易频率、通话频率，识别高频联系人
- **金额分析**: 分析交易金额分布、大额交易识别
- **时间分析**: 分析交易时间模式、工作日/周末分布
- **存取现识别**: 智能识别银行数据中的存取现交易

### 高级分析
- **行为模式分析**: 识别用户的交易习惯和行为特征
- **异常检测**: 检测异常交易、可疑行为模式
- **关联分析**: 分析不同数据源之间的关联关系

### 综合分析
- **跨平台分析**: 整合银行、微信、支付宝数据进行综合分析
- **交叉验证**: 通过多数据源验证交易的真实性和一致性
- **关系网络**: 构建基于交易和通话的关系网络
- **多基准分析**: 支持以话单、账单类或单个平台为基准的交叉分析

## 📈 报告功能

### Excel报告
- **分析汇总表**: 各平台汇总数据概览，提供整体数据统计
- **账单类频率表**: 银行、微信、支付宝交易频率分析
- **话单类频率表**: 通话记录频率分析，包含通话时长统计
- **综合分析表**: 全方位多基准交叉分析，支持传统分析和平台分析
- **平台原始数据**: 各平台的原始数据展示，便于数据验证

### Word报告
- **个人详细分析**: 按人员分组的详细分析报告，包含交易模式分析
- **综合交叉分析**: 多数据源关联分析，展示不同平台间的关联关系
- **重点收支分析**: 重要交易和收支模式分析，识别关键交易
- **专业分析报告**: 包含统计分析和可视化结果的专业报告

## 🚀 使用方式

### 安装依赖
在运行项目前，请先安装所需的Python依赖包：

```bash
pip install -r requirements.txt
```

### 命令行启动
```bash
python main.py
```

### 主要操作流程
1. **数据加载**: 选择并加载银行、微信、支付宝、话单数据文件
2. **执行分析**: 对加载的数据执行全面分析或专项分析
3. **导出报告**: 生成Excel或Word格式的分析报告

## ⚙️ 配置说明

系统使用`config.json`文件进行配置管理，支持：
- **字段映射**: 自定义各数据源的字段名称映射
- **分析参数**: 配置分析算法的参数和阈值
- **导出设置**: 配置报告导出的格式和样式

## 🔄 版本历史

### v0.1.0 (2025年) - 主要版本发布

#### 🎯 核心功能增强
- **多源数据整合**: 支持银行、微信、支付宝、话单等多种数据源的统一处理
- **智能交叉分析**: 实现全方位多基准交叉分析，支持传统分析和平台分析
- **专业报告导出**: 提供Excel和Word格式的专业分析报告

#### 📊 分析功能完善
- **频率分析**: 交易频率、通话频率统计，高频联系人识别
- **金额分析**: 交易金额分布分析，大额交易识别
- **时间分析**: 交易时间模式分析，工作日/周末分布
- **整数金额分析**: 智能识别整数金额交易模式
- **特殊分析**: 特殊金额和特殊日期分析

#### 🔧 技术架构优化
- **模块化设计**: 清晰的模块分离，便于维护和扩展
- **配置管理**: 灵活的配置文件支持字段映射和参数配置
- **异常处理**: 完善的异常处理机制，提高系统稳定性

#### 🐛 问题修复
- **跨人员匹配逻辑**: 修复综合分析中的跨人员关联错误问题
- **字段兼容性**: 修复话单数据中通话时长字段名称不一致问题
- **数据准确性**: 确保每个通话记录只关联对应本人的账单数据

### v0.0.x 历史版本
- **v0.0.15**: 综合分析跨人员匹配逻辑修复
- **v0.0.13**: 综合分析交叉比对逻辑修复
- **早期版本**: 基础功能开发和架构搭建
